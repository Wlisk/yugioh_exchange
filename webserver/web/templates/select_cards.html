{% extends "base.html" %}
{% load partials %}

{% block subtitle %}: Select cards{% endblock %}

{% block main %}
  {% partialdef select-partial inline %}
  <hr>

  <div class="title exchanges">
    <h1>Select cards</h1>
  </div>

  <form method="GET" action="">
    <select id="filterType" name="filter_type">
      <option value="name" {% if filter_type == 'name' %}selected{% endif %}>Name</option>
      <option value="card_type" {% if filter_type == 'card_type' %}selected{% endif %}>Card Type</option>
      <option value="monster_type" {% if filter_type == 'monster_type' %}selected{% endif %}>Monster Type</option>
    </select>
  
    <input id="searchField" type="text" name="q" placeholder="Search..." value="{{ query }}">
  
    <button id="searchButton" type="submit">Search</button>
  </form>

  <form method="POST" 
    id="selectForm" 
    hx-post="/make_exchange/"
    hx-target="#main-content"
    hx-swap="innerHTML"
    hx-ext="json-enc">
    <!-- no need for csrf_token as it is already on the body tag of base.html -->
    <div>
      <br>

      <div id="errorMessage" class="text-red-600 font-semibold mb-2"></div>
      
      {% for card in cards %}
        <label class="card-label">
          <input type="checkbox" name="cards" value="{{ card.id }}">

          <div class="card-info">
            <strong>{{ card.name }}</strong><br>
            <span class="card-type">{{ card.card_type.value }}{% if card.monster_type %} - {{ card.monster_type.value }}{% endif %}</span>
          </div>
        </label>
      <br>
      {% endfor %}
    </div>

    <br>

    <button id="continueButton" type="submit">Continue</button>
  </form>
  {% endpartialdef select-partial %}
{% endblock main %}